
        <main>
            <!-- Navigation -->
            <nav class="flex justify-center mb-10 md:mb-12 border-b border-gray-200">
                <button data-target="overview" class="main-nav-btn px-4 py-3 md:px-6 text-sm md:text-base font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none">Overview</button>
                <button data-target="steps" class="main-nav-btn px-4 py-3 md:px-6 text-sm md:text-base font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none">Interactive Steps</button>
                <button data-target="techniques" class="main-nav-btn px-4 py-3 md:px-6 text-sm md:text-base font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none">Key Techniques</button>
            </nav>

            <!-- Content Sections -->
            <div id="content-container">
                
                <!-- Overview Section -->
                <section id="overview" class="main-content">
                    <div class="text-center">
                        <h2 class="text-2xl md:text-3xl font-bold text-gray-900">How It Works: The Big Picture</h2>
                        <p class="mt-3 text-lg text-gray-600 max-w-2xl mx-auto">This guide shows you how to build a repeatable process. You point Power Query to a folder of PDFs, teach it how to clean one file, and it automatically applies those steps to every file, combining them into a single, clean table in Excel.</p>
                    </div>

                    <div class="mt-12 bg-white p-6 md:p-8 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="text-xl font-semibold text-center mb-8">The Automated Workflow</h3>
                        <div class="flex flex-col md:flex-row justify-around items-center text-center">
                            <div class="flex-1 mb-8 md:mb-0 md:mr-4">
                                <div class="arrow arrow-stack flex items-center justify-center bg-green-50 text-green-800 p-4 rounded-lg h-24 border border-green-200">
                                    <p class="font-semibold">1. A Folder of PDFs</p>
                                </div>
                            </div>
                            <div class="flex-1 mb-8 md:mb-0 md:mr-4">
                                 <div class="arrow arrow-stack flex items-center justify-center bg-blue-50 text-blue-800 p-4 rounded-lg h-24 border border-blue-200">
                                    <p class="font-semibold">2. Power Query Magic</p>
                                </div>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-center bg-gray-100 text-gray-800 p-4 rounded-lg h-24 border border-gray-200">
                                    <p class="font-semibold">3. One Clean Excel Table</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-10">
                        <h3 class="text-xl font-semibold text-center mb-6">What You'll Need</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-lg">Excel 365</h4>
                                <p class="text-gray-600 mt-2">Power Query is a built-in feature in modern Excel versions.</p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-lg">Consistent PDFs</h4>
                                <p class="text-gray-600 mt-2">Your files should have a similar table structure for the best results.</p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-lg">A Dedicated Folder</h4>
                                <p class="text-gray-600 mt-2">Keep all your source PDFs (and nothing else) in one place.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Interactive Steps Section -->
                <section id="steps" class="main-content hidden">
                    <div class="text-center">
                        <h2 class="text-2xl md:text-3xl font-bold text-gray-900">The Core Process: A Guided Walkthrough</h2>
                        <p class="mt-3 text-lg text-gray-600 max-w-2xl mx-auto">Follow these steps to build your query. Click on each tab to reveal the instructions for that part of the process. This is where you tell Excel what to do.</p>
                    </div>

                    <div class="mt-12 md:flex">
                        <div class="md:w-1/3 lg:w-1/4 mb-8 md:mb-0 md:mr-8">
                            <div class="flex md:flex-col rounded-lg border border-gray-200 bg-white p-2">
                                <button data-tab="step1" class="step-tab w-full text-left p-3 rounded font-medium text-sm md:text-base focus:outline-none">1. Connect to Folder</button>
                                <button data-tab="step2" class="step-tab w-full text-left p-3 rounded font-medium text-sm md:text-base focus:outline-none mt-1">2. Define Transformation</button>
                                <button data-tab="step3" class="step-tab w-full text-left p-3 rounded font-medium text-sm md:text-base focus:outline-none mt-1">3. Combine & Review</button>
                                <button data-tab="step4" class="step-tab w-full text-left p-3 rounded font-medium text-sm md:text-base focus:outline-none mt-1">4. Final Polish</button>
                                <button data-tab="step5" class="step-tab w-full text-left p-3 rounded font-medium text-sm md:text-base focus:outline-none mt-1">5. Close & Load</button>
                            </div>
                        </div>

                        <div class="md:w-2/3 lg:w-3/4 bg-white p-6 md:p-8 rounded-xl shadow-sm border border-gray-200 min-h-[300px]">
                            <div id="step1" class="step-content">
                                <h3 class="text-xl font-bold text-gray-900">Step 1: Connect to the Source Folder</h3>
                                <p class="mt-2 text-gray-600">First, we point Excel to the folder containing your PDFs. This tells Power Query where to look for the files.</p>
                                <ul class="mt-4 space-y-3 list-decimal list-inside text-gray-700">
                                    <li>Open a blank Excel workbook.</li>
                                    <li>Navigate to the <code class="bg-gray-100 text-sm px-1.5 py-0.5 rounded">Data</code> tab on the ribbon.</li>
                                    <li>Click <code class="bg-gray-100 text-sm px-1.5 py-0.5 rounded">Get Data > From File > From Folder</code>.</li>
                                    <li>Browse to and select your folder.</li>
                                    <li>In the preview window, click the dropdown on the <code class="bg-gray-100 text-sm px-1.5 py-0.5 rounded">Combine</code> button and select <code class="bg-gray-100 text-sm px-1.5 py-0.5 rounded">Combine & Transform Data</code>. This opens the Power Query Editor.</li>
                                </ul>
                            </div>
                            <div id="step2" class="step-content hidden">
                                <h3 class="text-xl font-bold text-gray-900">Step 2: Define the Transformation on a Sample</h3>
                                <p class="mt-2 text-gray-600">Now, you'll teach Power Query how to clean the data by working with a single sample file. Every action you take here will be recorded and applied to all other files.</p>
                                <ul class="mt-4 space-y-3 list-decimal list-inside text-gray-700">
                                    <li>Power Query opens a "Combine Files" helper window.</li>
                                    <li>On the left, select the table or page from the sample PDF that contains the data you need. A preview will appear.</li>
                                    <li>Once you've found the correct data, click <code class="bg-gray-100 text-sm px-1.5 py-0.5 rounded">OK</code>.</li>
                                    <li>You are now in the main Power Query Editor. Use the tools in the ribbon to clean the sample data (e.g., Use First Row as Headers, Change Data Types, Remove Columns).</li>
                                </ul>
                            </div>
                            <div id="step3" class="step-content hidden">
                                <h3 class="text-xl font-bold text-gray-900">Step 3: Combine and Review the Full Dataset</h3>
                                <p class="mt-2 text-gray-600">When you finished with the sample file, Power Query automatically created a function and applied it to every PDF in the folder, stacking the results into one query.</p>
                                <ul class="mt-4 space-y-3 list-decimal list-inside text-gray-700">
                                     <li>Your main query now shows the combined, transformed data from all files.</li>
                                     <li>Scroll through the data to ensure everything looks correct.</li>
                                     <li>Power Query adds a <code class="bg-gray-100 text-sm px-1.5 py-0.5 rounded">Source.Name</code> column showing the origin filename for each row, which is useful for verification.</li>
                                </ul>
                            </div>
                            <div id="step4" class="step-content hidden">
                                <h3 class="text-xl font-bold text-gray-900">Step 4: Final Polish</h3>
                                <p class="mt-2 text-gray-600">Before loading the data into Excel, perform a few final checks on the combined dataset.</p>
                                <ul class="mt-4 space-y-3 list-decimal list-inside text-gray-700">
                                    <li>Double-check that all columns have the correct data type (e.g., number, text, date).</li>
                                    <li>Rename or remove the <code class="bg-gray-100 text-sm px-1.5 py-0.5 rounded">Source.Name</code> column if you don't need it.</li>
                                    <li>In the "Query Settings" pane on the right, give your query a descriptive name (e.g., `CombinedPDFData`).</li>
                                </ul>
                            </div>
                            <div id="step5" class="step-content hidden">
                                <h3 class="text-xl font-bold text-gray-900">Step 5: Close & Load to Excel</h3>
                                <p class="mt-2 text-gray-600">The transformation is complete. It's time to send the clean, combined data back to your Excel worksheet.</p>
                                <ul class="mt-4 space-y-3 list-decimal list-inside text-gray-700">
                                    <li>On the <code class="bg-gray-100 text-sm px-1.5 py-0.5 rounded">Home</code> tab of the Power Query Editor, click the <code class="bg-gray-100 text-sm px-1.5 py-0.5 rounded">Close & Load</code> button.</li>
                                    <li>Power Query will create a new worksheet and load your data into a formatted Excel Table.</li>
                                    <li>Your data is now ready for analysis, PivotTables, or charts.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Key Techniques Section -->
                <section id="techniques" class="main-content hidden">
                    <div class="text-center">
                        <h2 class="text-2xl md:text-3xl font-bold text-gray-900">Key Techniques & The Payoff</h2>
                        <p class="mt-3 text-lg text-gray-600 max-w-2xl mx-auto">These are the most common actions you'll take to clean your data in Power Query, plus how to refresh your query when new files are added.</p>
                    </div>

                    <div class="mt-12">
                         <h3 class="text-xl font-semibold text-center mb-6">Common Data Cleaning Steps</h3>
                         <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-green-700">Use First Row as Headers</h4>
                                <p class="text-gray-600 mt-2">Promotes the first row of your data to become the table's column headers.</p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-green-700">Change Data Type</h4>
                                <p class="text-gray-600 mt-2">Crucial for calculations. Set columns to Text, Whole Number, Date, etc.</p>
                            </div>
                             <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-green-700">Remove Columns</h4>
                                <p class="text-gray-600 mt-2">Right-click a column header to remove any data you don't need.</p>
                            </div>
                             <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-green-700">Filter Rows</h4>
                                <p class="text-gray-600 mt-2">Use the filter dropdowns to exclude totals, summaries, or blank rows.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-12 bg-blue-50 border border-blue-200 p-8 rounded-xl text-center">
                        <h3 class="text-2xl font-bold text-blue-900">The Payoff: One-Click Refresh</h3>
                        <p class="mt-3 text-lg text-blue-800 max-w-2xl mx-auto">Once this is set up, the real power is in refreshing. When you add new PDFs to your source folder, just go to the <code class="bg-blue-100 text-sm px-1.5 py-0.5 rounded">Data</code> tab in Excel and click <code class="bg-blue-100 text-sm px-1.5 py-0.5 rounded">Refresh All</code>. Power Query will repeat all your steps automatically and update the table with the new data. No more manual work.</p>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        window.init_combine_pdfs = function() {
            const mainNavBtns = document.querySelectorAll('.main-nav-btn');
            const mainContentSections = document.querySelectorAll('.main-content');
            
            const stepTabs = document.querySelectorAll('.step-tab');
            const stepContents = document.querySelectorAll('.step-content');

            function activateMainNav(targetId) {
                mainNavBtns.forEach(btn => {
                    if (btn.dataset.target === targetId) {
                        btn.classList.add('border-green-500', 'text-green-600');
                        btn.classList.remove('text-gray-500', 'border-transparent');
                    } else {
                        btn.classList.remove('border-green-500', 'text-green-600');
                        btn.classList.add('text-gray-500', 'border-transparent');
                    }
                });

                mainContentSections.forEach(section => {
                    if (section.id === targetId) {
                        section.classList.remove('hidden');
                    } else {
                        section.classList.add('hidden');
                    }
                });
            }

            function activateStepTab(targetId) {
                stepTabs.forEach(tab => {
                    if (tab.dataset.tab === targetId) {
                        tab.classList.add('tab-active');
                    } else {
                        tab.classList.remove('tab-active');
                    }
                });

                stepContents.forEach(content => {
                    if (content.id === targetId) {
                        content.classList.remove('hidden');
                    } else {
                        content.classList.add('hidden');
                    }
                });
            }

            mainNavBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    activateMainNav(btn.dataset.target);
                });
            });

            stepTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    activateStepTab(tab.dataset.tab);
                });
            });

            activateMainNav('overview');
            activateStepTab('step1');
        };
    </script>
